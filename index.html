<!DOCTYPE html>
<html>
  <head>
    <title>Luckyspin-slotbangjago</title>
    <base target="_top">
    <!-- OneSignal -->
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
      window.OneSignalDeferred = window.OneSignalDeferred || [];
      OneSignalDeferred.push(async function(OneSignal) {
        await OneSignal.init({ appId: "00c33fd3-e850-4e1a-9773-a015271ec15e" });
        OneSignal.showSlidedownPrompt();
      });
    </script>
    <style>
      /* ... (CSS kamu tetap, tidak diubah) ... */
    </style>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  </head>
  <body>
    <img src="https://i.ibb.co/8LjX3z3Y/logo-sbj-png.png" alt="Logo" style="height: 80px; margin-bottom: 10px;" />
    <h2>Cari kode luckyspin anda disini</h2>

    <form id="search-form">
      <input type="text" id="searchtext" name="searchtext" placeholder="Masukkan User ID" required />
      <button type="submit">Cari</button>
      <div id="loading-spinner" style="display:none;">
        <div class="spinner"></div>
      </div>
    </form>

    <div id="result"></div>

    <!-- Tombol WA dan Telegram -->
    <a href="https://klikblg.com/tele-sbj" target="_blank" style="position: fixed; bottom: 90px; left: 20px; z-index: 9999;">
      <img src="https://i.ibb.co/qFNF754C/s-Wrh-ESzm4-Oh-UZql-Jg-Mvcz-c-Vr-Hw.gif" alt="Telegram" style="width: 60px; height: 60px; border-radius: 50%;" />
    </a>
    <a href="https://klikblg.com/wa-sbj" target="_blank" style="position: fixed; bottom: 20px; left: 20px; z-index: 9999;">
      <img src="https://i.ibb.co/mrvRcXRH/Wqtl0ij-Kix.gif" alt="WhatsApp" style="width: 60px; height: 60px; border-radius: 50%;" />
    </a>

    <!-- ✅ Script Utama -->
    <script>
      document.getElementById("search-form").addEventListener("submit", function (e) {
        e.preventDefault();
        const input = document.getElementById("searchtext").value.trim();
        const spinner = document.getElementById("loading-spinner");
        const result = document.getElementById("result");

        result.innerHTML = "";
        spinner.style.display = "flex";

        fetch(`https://script.google.com/macros/s/AKfycby6KadR_tDbNUMjdCvUh814fWVTAKAS3vrDAtdofFW7V2iDHig1MoGI04Ndzmws7Ms/exec?searchtext=${encodeURIComponent(input)}`)
          .then(response => response.json())
          .then(response => {
            spinner.style.display = "none";
            if (response && response.length > 0) {
              confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
              let table = `<table class="result-table"><thead><tr><th>USERID</th><th>KODE LUCKYSPIN</th><th>TANGGAL</th></tr></thead><tbody>`;

              response.forEach(row => {
                table += `<tr><td>${row[0]}</td><td><div style="display:flex;justify-content:center;align-items:center;gap:10px;"><span>${row[1]}</span><button class="copy-btn" onclick="copyToClipboard('${row[1]}')">Copy</button></div></td><td>${row[2]}</td></tr>`;
              });

              table += "</tbody></table>";
              table += `<div style="margin-top: 20px;"><a href="https://maxwinputar.com/lucky-wheel-slotbangjago/" target="_blank"><button style="background-color:#28a745;color:white;padding:10px 20px;border:none;border-radius:6px;font-size:16px;font-weight:bold;cursor:pointer;margin-top:10px;">KLIK INI UNTUK MEMUTAR KODE</button></a></div>`;
              result.innerHTML = table;
            } else {
              result.innerHTML = `<div style="color:red;font-weight:bold;margin-top:10px;">❌ Pastikan Userid anda sudah benar.</div>`;
            }
          })
          .catch(err => {
            spinner.style.display = "none";
            result.innerHTML = `<div style="color:red;">❌ Gagal terhubung ke server.</div>`;
          });
      });

      function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
          alert("Kode berhasil disalin!");
        });
      }

      window.addEventListener('DOMContentLoaded', () => {
        const urlParams = new URLSearchParams(window.location.search);
        const param = urlParams.get('searchtext');
        if (param) {
          document.getElementById("searchtext").value = param;
          document.getElementById("search-form").dispatchEvent(new Event("submit"));
        }
      });
    </script>
  </body>
</html>
